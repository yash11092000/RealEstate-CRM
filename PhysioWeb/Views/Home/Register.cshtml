@{
	ViewBag.Title = "Register";
	Layout = "_MinimalLayout";
}

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		:root {
			--theme-color: #198754;
			--theme-dark: #14532d;
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			background-color: #f8f9fa;
			overflow-x: hidden;
		}

		.gradient-bg {
			background: linear-gradient(135deg, var(--theme-color), var(--theme-dark)) !important;
			min-height: 40vh;
		}

		@@media (min-width: 769px) {
			.gradient-bg {
				min-height: 100vh;
			}
		}

		.card {
			border: none;
			border-radius: 12px;
			box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
		}

		.btn-success {
			background-color: var(--theme-dark);
			border-color: var(--theme-dark);
		}

			.btn-success:hover {
				background-color: #0f4725;
				border-color: #0f4725;
			}

		@@media (max-width: 768px) {
			.card {
				margin-top: -60px;
				margin-bottom: 2rem;
			}
		}
	</style>
</head>

<div class="row g-0 min-vh-100">
	<div class="col-12 col-md-6 gradient-bg d-flex flex-column justify-content-center align-items-center text-white p-4 p-md-5">
		<div class="text-center px-3">
			<h1 class="fw-bold display-5 mb-3">Find My Roof</h1>
			<p class="lead">Create an account and start your property journey today.</p>
		</div>
	</div>
	<div class="col-12 col-md-6 d-flex flex-column justify-content-center align-items-center bg-light p-3 p-md-4">
		<div class="card shadow-sm p-3 p-md-4 w-100" style="max-width:400px;">
			<h3 class="text-center mb-4 text-success">Register</h3>

			<form id="RegisterForm">
				<!-- Full Name -->
				<div class="form-floating mb-3">
					<input type="text" class="form-control" id="Name" placeholder="Name">
					<label for="Name">Full Name</label>
				</div>

				<!-- Email -->
				<div class="form-floating mb-3">
					<input type="email" class="form-control" id="Email" placeholder="name@example.com">
					<label for="Email">Email address</label>
				</div>

				<!-- Mobile -->
				<div class="form-floating mb-3">
					<input type="tel" class="form-control" id="Mobile" placeholder="9876543210" pattern="[0-9]{10}">
					<label for="Mobile">Mobile Number</label>
				</div>

				<!-- Password -->
				<div class="form-floating mb-3">
					<input type="password" class="form-control" id="Password" placeholder="Password">
					<label for="Password">Password</label>
				</div>

				<!-- Confirm Password -->
				<div class="form-floating mb-3">
					<input type="password" class="form-control" id="ConfirmPassword" placeholder="Confirm Password">
					<label for="ConfirmPassword">Confirm Password</label>
				</div>

				<!-- Terms Checkbox -->
				<div class="form-check mb-3">
					<input class="form-check-input" type="checkbox" id="terms">
					<label class="form-check-label small" for="terms">
						I agree to the <a href="#" class="text-success">Terms & Conditions</a>
					</label>
				</div>

				<!-- Register Button -->
				<button type="button" class="btn btn-success w-100" id="Register">Create Account</button>
			</form>

			<p class="text-center small mt-3">
				Already have an account? <a href="/Home/Login" class="text-success">Login</a>
			</p>
		</div>
	</div>
</div>


@section Scripts {
	<script>
		$("#Register").on("click",function(){

			let fullName = $("#Name").val().trim();
			let email = $("#Email").val().trim();
			let mobile = $("#Mobile").val().trim();
			let password = $("#Password").val();
			let confirmPassword = $("#ConfirmPassword").val();

			const mobileRegex = new RegExp("^[6-9][0-9]{9}$");
			const emailRegex = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;

		  // ✅ Frontend Validation
			if (fullName.length < 3) {
				notyf.error("Full Name must be at least 3 characters.");
				return;
			}
			if (!emailRegex.test(email)) {
				notyf.error("Enter a valid Email address.");
				return;
			}
			if (!mobileRegex.test(mobile)) {
				notyf.error("Enter a valid 10-digit Mobile Number.");
				return;
			}
			if (password.length < 6) {
				notyf.error("Password must be at least 6 characters.");
				return;
			}
			if (password !== confirmPassword) {
				notyf.error("Passwords do not match!");
				return;
			}
			if (!$("#terms").is(":checked")) {
				notyf.error("Please accept Terms & Conditions!");
				return;
			}


			var formData = {
				Name: fullName,
				Email: email,
				Mobile: mobile,
				Password: password
			};

			// ✅ AJAX Submit
			$.ajax({
				url: "/Home/Register",
				type: "POST",
				data: formData,
				success: function (response) {
					if (response) {
						notyf.success("Registration successful!");
						setTimeout(function () {
							window.location.href = "/Home/Login";
						}, 2000);
					} else {
						notyf.error(response || "Registration failed!");
					}
				},
				error: function () {
					notyf.error("An error occurred. Try again.");
				}
			});
		});


	</script>
}