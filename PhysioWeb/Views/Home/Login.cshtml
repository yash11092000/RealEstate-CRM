@{
	ViewBag.Title = "Login";
	Layout = "_MinimalLayout";
}
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		:root {
			--theme-color: #198754;
			--theme-dark: #14532d;
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			background-color: #f8f9fa;
			overflow-x: hidden;
		}

		.gradient-bg {
			background: linear-gradient(135deg, var(--theme-color), var(--theme-dark)) !important;
			min-height: 40vh;
		}

		@@media (min-width: 769px) {
			.gradient-bg {
				min-height: 100vh;
			}
		}

		.card {
			border: none;
			border-radius: 12px;
			box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
		}

		.btn-success {
			background-color: var(--theme-dark);
			border-color: var(--theme-dark);
		}

			.btn-success:hover {
				background-color: #0f4725;
				border-color: #0f4725;
			}

		@@media (max-width: 768px) {
			.card {
				margin-top: -60px;
				margin-bottom: 2rem;
			}
		}
	</style>
</head>
<div class="row g-0 min-vh-100">
	<!-- Left: Gradient Background with Slogan -->
	<div class="col-12 col-md-6 gradient-bg d-flex flex-column justify-content-center align-items-center text-white p-4 p-md-5">
		<div class="text-center px-3">
			<h1 class="fw-bold display-5 mb-3">Find My Roof</h1>
			<p class="lead">Your dream home is just a click away.</p>
		</div>
	</div>

	<!-- Right: Login Form -->
	<div class="col-12 col-md-6 d-flex flex-column justify-content-center align-items-center bg-light p-3 p-md-4">
		<div class="card shadow-sm p-3 p-md-4 w-100" style="max-width:400px;">
			<h3 class="text-center mb-4 text-success">Sign In</h3>

			<form id="loginForm">
				<!-- Email -->
				<div class="form-floating mb-3">
					<input type="email" class="form-control" id="floatingEmail" placeholder="name@example.com">
					<label for="floatingEmail">Email address</label>
				</div>

				<!-- Mobile -->
				<div class="form-floating mb-3">
					<input type="tel" class="form-control" id="floatingMobile" placeholder="9876543210" pattern="[0-9]{10}">
					<label for="floatingMobile">Mobile Number</label>
				</div>

				<!-- Password -->
				<div class="form-floating mb-3">
					<input type="password" class="form-control" id="floatingPassword" placeholder="Password">
					<label for="floatingPassword">Password</label>
				</div>

				<!-- Remember / Forgot -->
				<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
					<div class="form-check">
						<input class="form-check-input" type="checkbox" id="remember">
						<label class="form-check-label small" for="remember">Remember me</label>
					</div>
					<a href="#" class="small text-success text-decoration-none">Forgot password?</a>
				</div>

				<!-- Button -->
				<button type="button" class="btn btn-success w-100" id="login">Login</button>
			</form>

			<p class="text-center small mt-3">
				Don't have an account? <a href="/Home/Register" class="text-success text-decoration-none">Register</a>
			</p>
		</div>
	</div>
</div>
@section Scripts {
	<script>
		$("#login").on("click", function (e) {
			let email = $("#floatingEmail").val().trim();
			let mobile = $("#floatingMobile").val().trim();
			let password = $("#floatingPassword").val();

			const mobileRegex = new RegExp("^[6-9][0-9]{9}$");
			const emailRegex = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;


			if (!emailRegex.test(email)) {
				notyf.error("Enter a valid Email address.");
				return;
			}
			else if (mobile && !mobileRegex.test(mobile)) {
				notyf.error("Enter a valid 10-digit Mobile Number.");
				return;
			}
			else if (password.length < 6) {
				notyf.error("Password must be at least 6 characters.");
				return;
			}
			else{

				$.ajax({
					url: "/Home/Login",
					type: "POST",
					data: {Email:email,Mobile: mobile,Password: password},
					success: function (response) {
							showLoader();
						  if (response.success) {
						notyf.success("Login successful! Redirecting...");

						setTimeout(() => window.location.href = response.redirect, 1500);
					} else {
						notyf.error(response.message || "Invalid credentials!");
					}
					},
					error: function () {
						hideLoader();
						notyf.error("An error occurred. Try again.");
					}
				});
				hideLoader();
			}
		});

	</script>

	}
