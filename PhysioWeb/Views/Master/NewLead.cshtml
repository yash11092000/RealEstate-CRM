@model PhysioWeb.Models.NewLead
@{
	ViewBag.Title = "New Lead";
	var theme = User.FindFirst("Theme")?.Value ?? "#198754";

}

<style>
	:root {
		--theme-color: @theme;
		--sidebar-width: 280px;
		--sidebar-collapsed-width: 70px;
		--transition-speed: 0.3s;
		--primary-color: @theme;
		--secondary-color: #6c757d;
		--light-bg: #f8f9fa;
	}

	.stepper {
		list-style: none;
		padding: 0;
		margin: 0;
		display: flex;
		position: relative;
	}

		.stepper .step {
			flex: 1;
			text-align: center;
			font-weight: 500;
			color: #777;
			position: relative;
		}

			.stepper .step span {
				display: inline-block;
				width: 35px;
				height: 35px;
				line-height: 35px;
				border-radius: 50%;
				background: #dcdcdc;
				color: #fff;
				margin-bottom: 5px;
				transition: all 0.3s ease;
			}

			.stepper .step.active span {
				background: var(--theme-color);
				transform: scale(1.1);
			}

			.stepper .step.completed span {
				background: var(--theme-color);
			}

	.text-primary {
		color: var(--theme-color) !important;
	}

	.stepper .step::after {
		content: '';
		position: absolute;
		top: 17px;
		left: 50%;
		width: 100%;
		height: 3px;
		background: #dcdcdc;
		z-index: -1;
	}

	.stepper .step:last-child::after {
		display: none;
	}

	.stepper .step.completed::after {
		background: var(--theme-color);
	}

	.nav-tabs .nav-link {
		color: var(--theme-color);
		font-weight: 600;
		border: 2px solid transparent;
		border-radius: 0.5rem 0.5rem 0 0;
		transition: all 0.3s ease-in-out;
	}

		.nav-tabs .nav-link:hover {
			background: #e6f4ea;
			border-color: var(--theme-color);
			color: var(--theme-color);
		}

		.nav-tabs .nav-link.active {
			background: var(--theme-color);
			color: white !important;
			border-color: var(--theme-color);
		}
</style>

<link rel="stylesheet" href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.min.css" />
<main class="dashboard-content with-sidebar collapsed">
	<div class="container-fluid mt-4">
		<ul class="nav nav-tabs" id="leadTabs" role="tablist">
			<li class="nav-item" role="presentation">
				<button class="nav-link active" id="new-lead-tab" data-bs-toggle="tab" data-bs-target="#new-lead" type="button" role="tab" aria-controls="new-lead" aria-selected="true">
					<i class="bi bi-person-plus"></i> Add New Lead
				</button>
			</li>
			<li class="nav-item" role="presentation">
				<button class="nav-link" id="all-leads-tab" data-bs-toggle="tab" data-bs-target="#all-leads" type="button" role="tab" aria-controls="all-leads" aria-selected="false">
					<i class="bi bi-list-stars"></i> All Leads
				</button>
			</li>
		</ul>

		<div class="tab-content border border-top-0 p-4" id="leadTabsContent">
			<div class="tab-pane fade show active" id="new-lead" role="tabpanel" aria-labelledby="new-lead-tab">
				<div class="row">
					<div class="col-md-12">
						<form asp-action="Create" method="post" id="leadForm">
							<div asp-validation-summary="ModelOnly" class="text-danger"></div>

							<!-- Lead Information -->
							<div class="card p-3 mb-4 shadow-sm">
								<h5 class="card-title text-primary"><i class="bi bi-info-circle-fill"></i> Lead Information</h5>
								<div class="row">
									<div class="col-md-4 mb-3">
										<label asp-for="LeadId" class="form-label"></label>
										<input asp-for="LeadId" class="form-control" readonly />
										<span asp-validation-for="LeadId" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="LeadSource" class="form-label"></label>
										<select class="form-select">
											<option value="">-- Select LeadSource --</option>
											@foreach (var Type in Model.LeadSourceList)
											{
												<option value="@Type.Value">@Type.Text</option>

											}
										</select>
										<span asp-validation-for="LeadSource" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="LeadType" class="form-label"></label>
										<select class="form-select">
											<option value="">-- Select Type --</option>
											@foreach (var Type in Model.LeadTypeList)
											{
												<option value="@Type.Value">@Type.Text</option>

											}
										</select>
										<span asp-validation-for="LeadType" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="LeadStatus" class="form-label"></label>
										<select class="form-select">
											<option value="">-- Select Status --</option>
											@foreach (var Type in Model.LeadStatusList)
											{
												<option value="@Type.Value">@Type.Text</option>

											}
										</select>
										<span asp-validation-for="LeadStatus" class="text-danger"></span>
									</div>
								</div>
							</div>

							<!-- Personal / Contact Details -->
							<div class="card p-3 mb-4 shadow-sm">
								<h5 class="card-title text-primary"><i class="bi bi-person-fill"></i> Personal / Contact Details</h5>
								<div class="row">
									<div class="col-md-6 mb-3">
										<label asp-for="FullName" class="form-label"></label>
										<input asp-for="FullName" class="form-control" placeholder="John Doe" />
										<span asp-validation-for="FullName" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="Email" class="form-label"></label>
										<input asp-for="Email" class="form-control" type="email" placeholder="john.doe@example.com" />
										<span asp-validation-for="Email" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="PhoneNumber" class="form-label"></label>
										<input asp-for="PhoneNumber" class="form-control" placeholder="123-456-7890" />
										<span asp-validation-for="PhoneNumber" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="AlternateNumber" class="form-label"></label>
										<input asp-for="AlternateNumber" class="form-control" placeholder="Alternate contact number" />
										<span asp-validation-for="AlternateNumber" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="PreferredContactMethod" class="form-label"></label>
										<select asp-for="PreferredContactMethod" asp-items="@(new SelectList(Model.PreferredContactMethodList, "Value", "Text"))" class="form-select">
											<option value="">-- Select Method --</option>
										</select>
										<span asp-validation-for="PreferredContactMethod" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="FollowUpDate" class="form-label"></label>
										<input asp-for="FollowUpDate" class="form-control" type="date" />
										<span asp-validation-for="FollowUpDate" class="text-danger"></span>
									</div>
								</div>
							</div>

							<!-- Property Requirements -->
							<div class="card p-3 mb-4 shadow-sm">
								<h5 class="card-title text-primary"><i class="bi bi-house-fill"></i> Property Requirements</h5>
								<div class="row">
									<div class="col-md-4 mb-3">
										<label asp-for="RequirementType" class="form-label"></label>
										<select class="form-select" id="RequirementId">
											<option value="">-- Select RequirementType --</option>
											@foreach (var Type in Model.RequirementTypeList)
											{
												<option value="@Type.Value">@Type.Text</option>
											}
										</select>
										<span asp-validation-for="RequirementType" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="PropertyType" class="form-label"></label>

										<select class="form-select" id="PropertyType" name="PropertyType">
											<option value="">-- Select PropertyType --</option>
											@foreach (var Type in Model.PropertyTypeList)
											{
												<option value="@Type.Value">@Type.Text</option>

											}
										</select>
										<span asp-validation-for="PropertyType" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="LocationPreference" class="form-label"></label>
										<input asp-for="LocationPreference" class="form-control" placeholder="Preferred area" />
										<span asp-validation-for="LocationPreference" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="BudgetMin" class="form-label"></label>
										<input asp-for="BudgetMin" class="form-control" type="number" step="0.01" placeholder="Min Budget" />
										<span asp-validation-for="BudgetMin" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="BudgetMax" class="form-label"></label>
										<input asp-for="BudgetMax" class="form-control" type="number" step="0.01" placeholder="Max Budget" />
										<span asp-validation-for="BudgetMax" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="Bedrooms" class="form-label"></label>
										<select class="form-select" id="Bedrooms" name="Bedrooms">
											<option value="">-- Select Bedroom--</option>
											@foreach (var Type in Model.BedroomsList)
											{
												<option value="@Type.Value">@Type.Text</option>
											}
										</select>
										<span asp-validation-for="Bedrooms" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="FurnishingType" class="form-label"></label>
										<select class="form-select" id="FurnishingType" name="FurnishingType">
											<option value="">-- Select FurnishingType --</option>
											@foreach (var Type in Model.FurnishingTypeList)
											{
												<option value="@Type.Value">@Type.Text</option>

											}
										</select>
										<span asp-validation-for="FurnishingType" class="text-danger"></span>
									</div>
									<div class="col-md-4 mb-3">
										<label asp-for="PossessionTimeframe" class="form-label"></label>
										<select asp-for="PossessionTimeframe" asp-items="@(new SelectList(Model.PossessionTimeframeList, "Value", "Text"))" class="form-select">
											<option value="">-- Select Timeframe --</option>
										</select>
										<span asp-validation-for="PossessionTimeframe" class="text-danger"></span>
									</div>
								</div>
							</div>

							<!-- Broker / Agent Assignment -->
							<div class="card p-3 mb-4 shadow-sm">
								<h5 class="card-title text-primary"><i class="bi bi-person-badge"></i> Broker / Agent Assignment</h5>
								<div class="row">
									<div class="col-md-6 mb-3">
										<label asp-for="AssignedAgent" class="form-label"></label>
										<select asp-for="AssignedAgent" asp-items="@(new SelectList(Model.AgentList, "Value", "Text"))" class="form-select">
											<option value="">-- Select Agent --</option>
										</select>
										<span asp-validation-for="AssignedAgent" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="CreatedBy" class="form-label"></label>
										<input asp-for="CreatedBy" class="form-control" readonly />
										<span asp-validation-for="CreatedBy" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="CreatedDate" class="form-label"></label>
										<input asp-for="CreatedDate" class="form-control" type="date" readonly />
										<span asp-validation-for="CreatedDate" class="text-danger"></span>
									</div>
									<div class=" col-md-6 mb-3 form-group">
										<label class="form-check-label" for="ReminderNotification">
											Property Interested In
										</label>
										<select asp-for="PropertyInterestedIn" class="form-control">
											<option value="">-- Select Property --</option>
											<option value="P001">Green Valley Apartments</option>
											<option value="P002">Sunshine Villas</option>
											<option value="P003">Lakeview Heights</option>
											<option value="P004">Downtown Commercial Plaza</option>
											<option value="P005">Silver Leaf Residency</option>
										</select>
										<span asp-validation-for="PropertyInterestedIn" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3 form-check">
										<input class="form-check-input" type="checkbox" id="ReminderNotification" name="ReminderNotification">
										<label class="form-check-label" for="ReminderNotification">
											Set Reminder / Send Notification
										</label>
									</div>

								</div>
							</div>

							<!-- Additional Details -->
							<div class="card p-3 mb-4 shadow-sm">
								<h5 class="card-title text-primary"><i class="bi bi-sticky"></i> Additional Details</h5>
								<div class="row">
									<div class="col-md-6 mb-3">
										<label asp-for="LeadPriority" class="form-label"></label>
										<select asp-for="LeadPriority" asp-items="@(new SelectList(Model.LeadPriorityList, "Value", "Text"))" class="form-select">
											<option value="">-- Select Priority --</option>
										</select>
										<span asp-validation-for="LeadPriority" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="LeadRating" class="form-label"></label>
										<select asp-for="LeadRating" asp-items="@(new SelectList(Model.LeadRatingList, "Value", "Text"))" class="form-select">
											<option value="">-- Select Rating --</option>
										</select>
										<span asp-validation-for="LeadRating" class="text-danger"></span>
									</div>
									<div class="col-md-6 mb-3">
										<label asp-for="IsActive" class="form-label"></label>
										<select asp-for="IsActive" class="form-select">
											<option value="true">Active</option>
											<option value="false">Inactive</option>
										</select>
										<span asp-validation-for="IsActive" class="text-danger"></span>
									</div>
									<div class="col-md-12 mb-3">
										<label asp-for="Notes" class="form-label"></label>
										<textarea asp-for="Notes" class="form-control" rows="4" placeholder="Enter remarks or additional notes..."></textarea>
										<span asp-validation-for="Notes" class="text-danger"></span>
									</div>
								</div>
							</div>

							<div class="d-grid gap-2 d-md-flex justify-content-md-end">

								<button type="button" class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#bulkImportModal">
									<i class="bi bi-file-earmark-arrow-up"></i> Bulk Import
								</button>
								<button type="submit" class="btn btn-success btn-lg me-md-2" style="background-color: @theme; border-color: @theme;">
									<i class="bi bi-save"></i> Save Lead
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>

			<!-- All Leads Tab (Static Example) -->
			<div class="tab-pane fade" id="all-leads" role="tabpanel" aria-labelledby="all-leads-tab">
				<table class="table table-striped table-hover mt-3">
					<thead class="table-primary">
						<tr>
							<th>Lead ID</th>
							<th>Full Name</th>
							<th>Lead Status</th>
							<th>Lead Source</th>
							<th>Assigned Agent</th>
							<th>Created Date</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>LEAD001</td>
							<td>Michael Scott</td>
							<td><span class="badge bg-warning">Interested</span></td>
							<td>Website</td>
							<td>Agent 1</td>
							<td>2025-11-01</td>
							<td><button class="btn btn-sm btn-info">View</button></td>
						</tr>
						<tr>
							<td>LEAD002</td>
							<td>Pam Beesly</td>
							<td><span class="badge bg-success">Converted</span></td>
							<td>Referral</td>
							<td>Agent 2</td>
							<td>2025-11-05</td>
							<td><button class="btn btn-sm btn-info">View</button></td>
						</tr>
						<tr>
							<td>LEAD003</td>
							<td>Dwight Schrute</td>
							<td><span class="badge bg-secondary">New</span></td>
							<td>Google Ads</td>
							<td>Agent 3</td>
							<td>2025-11-07</td>
							<td><button class="btn btn-sm btn-info">View</button></td>
						</tr>
					</tbody>
				</table>
				<div class="d-flex justify-content-between">
					<span class="text-muted">Showing 1 to 3 of 3 total leads.</span>
					<button class="btn btn-outline-secondary">Load More</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Bulk Import Modal -->
	<div class="modal fade" id="bulkImportModal" tabindex="-1" aria-labelledby="bulkImportModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header bg-primary text-white">
					<h5 class="modal-title" id="bulkImportModalLabel"><i class="bi bi-cloud-upload"></i> Bulk Lead Import</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<form asp-action="BulkImport" enctype="multipart/form-data" method="post">
					<div class="modal-body">
						@* <p>Select a CSV file to upload multiple leads.</p> *@
						<div class="mb-3">
							<label for="importFile" class="form-label">Upload CSV File</label>
							<input class="form-control" type="file" id="importFile" name="importFile" accept=".csv" required>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-primary">Start Import</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</main>
@section Scripts {
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			var triggerEl = document.querySelector('#leadTabs button[data-bs-target="#new-lead"]');
			if (triggerEl) {
				bootstrap.Tab.getInstance(triggerEl).show();
			}
		});
	</script>
}