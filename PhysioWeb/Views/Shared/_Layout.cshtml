<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - Find My Roof</title>
	<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
	<link rel="stylesheet" href="~/PhysioWeb.styles.css" asp-append-version="true" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
	<link href="~/css/aos.min.css" rel="stylesheet" asp-append-version="true" />
	<link href="~/css/choices.min.css" rel="stylesheet" asp-append-version="true" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_green.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.min.css" />
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">

	@{
		var theme = User.FindFirst("Theme")?.Value ?? "#198754";
	}
	<style>

		:root {
			--theme-color: @theme;
		}

		html {
			scroll-behavior: smooth;
		}

		.text-success {
			color: var(--theme-color) !important;
		}

		.btn-outline-success:hover {
			background-color: var(--theme-color) !important;
		}

		.btn:hover {
			color: #212529;
		}

		.btn-outline-success {
			color: var(--theme-color) !important;
			border-color: var(--theme-color) !important;
		}

		.bg-dark-green {
			background-color: var(--theme-color) !important;
		}

		.bg-success {
			background-color: var(--theme-color) !important;
		}

		.btn-success {
			color: #fff !important;
			background-color: var(--theme-color) !important;
			border-color: var(--theme-color) !important;
		}

		.navbar-dark .navbar-nav .nav-link {
			color: white !important;
		}

		.navbar-dark .navbar-brand {
			color: white !important;
		}

		.navbar-nav .nav-link {
			color: #ffffffcc;
			transition: all 0.3s ease-in-out;
			position: relative;
			font-weight: 500;
		}

			.navbar-nav .nav-link:hover {
				color: #ffffff; /* pure white on hover */
			}

			.navbar-nav .nav-link::after {
				content: "";
				position: absolute;
				width: 0%;
				height: 2px;
				background-color: #ffffff; /* white underline */
				left: 0;
				bottom: 0;
				transition: 0.3s;
			}

			.navbar-nav .nav-link:hover::after {
				width: 100%;
			}

		.footer a:hover {
			color: var(--theme-color) !important;
		}

		.impMark {
			color: #f75d5d;
		}

		#TableList {
			width: 100% !important;
			border-collapse: collapse;
		}

			#TableList thead th {
				background-color: #e9f5e9;
				color: var(--theme-color) !important;
				;
				font-weight: 600;
				text-align: center;
				vertical-align: middle;
			}

			#TableList tbody tr:hover {
				background-color: white;
			}

			#TableList tbody td {
				vertical-align: middle;
				text-align: center;
			}

			#TableList thead input {
				width: 100%;
				padding: 5px;
				box-sizing: border-box;
				font-size: 0.9rem;
			}

		.dataTables_wrapper .dataTables_paginate .paginate_button {
			padding: 0.3rem 0.75rem;
			margin: 2px;
			border-radius: 0.3rem;
		}

			.dataTables_wrapper .dataTables_paginate .paginate_button.current {
				background-color: var(--theme-color) !important;
				color: white !important;
				border: 1px solid var(--theme-color) !important;
			}

		.dataTables_wrapper .dataTables_filter input,
		.dataTables_wrapper .dataTables_length select {
			border-radius: 5px;
			padding: 5px;
			border: 1px solid #ced4da;
		}

		.footer {
			margin-top: auto; /* Push footer to bottom */
			width: 100%;
		}

		@@media (max-width: 576px) {
			.content-area {
				padding: 10px;
			}

			.footer {
				padding: 15px 0;
			}
		}

		footer {
			line-height: 30px !important;
		}

		.slide-btn {
			position: relative;
			overflow: hidden;
			transition: color 0.3s;
			z-index: 1;
		}

			.slide-btn:hover {
				color: #fff !important;
			}

				.slide-btn:hover::before {
					width: 100%;
				}

		.slide-btn {
			position: relative;
			overflow: hidden;
			z-index: 1;
			color: #fff;
			border: 2px solid var(--theme-color);
			background: transparent;
			padding: 10px 20px;
			cursor: pointer;
		}

			.slide-btn::before {
				content: "";
				position: absolute;
				left: 0;
				top: 0;
				bottom: 0;
				width: 0;
				background: var(--theme-color); /* dynamic theme color */
				z-index: -1;
				transition: width 0.4s cubic-bezier(0.45,0,0.55,1);
			}

	</style>
</head>
<body>
	<header class="sticky-top">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark-green">
			<div class="container-fluid">
				<a class="navbar-brand d-flex align-items-center" href="/">
					<i class="bi bi-house-door-fill me-2 text-light"></i>
					<strong class="text-light">CHEEDA PROPERTY</strong>
				</a>
				<button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse justify-content-end" id="navbarNav">
					<ul class="navbar-nav">
						<li class="nav-item"><a class="nav-link text-dark" href="/">Home</a></li>
						@if (User.IsInRole("SuperAdmin"))
						{
							<li class="nav-item"><a class="nav-link text-dark" href="/SuperAdmin/AdminDashboard">Admin Dashboard</a></li>


						}
						@if (User.IsInRole("Agency"))
						{
							<li class="nav-item"><a class="nav-link text-dark" href="/Agent/AgencyDashboard">Agency Dashboard</a></li>
						}
						@if (User.IsInRole("User"))
						{
							<li class="nav-item"><a class="nav-link text-dark" href="#">Buy</a></li>
							<li class="nav-item"><a class="nav-link text-dark" href="#">Sell</a></li>
							<li class="nav-item"><a class="nav-link text-dark" href="#">Rent</a></li>
						}
						@if (!User.Identity.IsAuthenticated)
						{
							<li class="nav-item"><a class="nav-link text-dark" href="/Home/Register">Sign Up</a></li>
							<li class="nav-item"><a class="nav-link text-dark" href="/Home/Login">Login</a></li>
						}
						else
						{

							string role = User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value?.ToUpper() ?? "";
							string icon = "bi-person"; // default icon

							if (role == "SUPERADMIN") { icon = "bi-shield-lock"; }
							else if (role == "AGENCY") { icon = "bi-building"; }
							else if (role == "USER") { icon = "bi-person-circle"; }

							<li class="nav-item">
								<input type="text" value="@role" hidden id="UserRole" />
								<span class="nav-link text-dark" style="font-weight:500;">
									<i class="bi @icon me-1"></i> @User.Identity.Name
								</span>
							</li>
							@if (User.IsInRole("SuperAdmin"))
							{
								<li>
									<button class="btn btn-light position-relative" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
										<i class="bi bi-bell"></i>
										<span class="mt-1 position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="NotificationCount">
											0
										</span>
									</button>
								</li>
							}

							<li class="nav-item"><a class="nav-link text-dark" href="/Home/Logout">Logout</a></li>

						}


					</ul>
				</div>
			</div>
		</nav>

	</header>

	<div class="container-fluid">
		<main role="main" class="pb-3">
			<div id="Side_Bar">
				<div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
					<div class="offcanvas-header">
						<h5 class="offcanvas-title" id="offcanvasScrollingLabel">Colored with scrolling</h5>
						<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
					</div>
					<div class="offcanvas-body">
						<p>Try scrolling the rest of the page to see this option in action.</p>
					</div>
				</div>
			</div>

			<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
				<div class="offcanvas-header">
					<h5 id="offcanvasRightLabel">Notifications</h5>
					<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
				</div>
				<div class="offcanvas-body" id="NotifiactionList">
					<ul class="list-group list-group-flush" id="notifListUl">
					</ul>
				</div>
			</div>

			@RenderBody()
		</main>
	</div>
	<!-- 🌟 Loader -->
	<div id="pageLoader"
		 style="position: fixed; top: 0; left: 0; width: 100%; height: 100%;
				background: rgba(255,255,255,0.9);
				display: flex; justify-content: center;
				align-items: center; z-index: 9999;">
		<img src="~/time hourglass.gif" alt="Loading..." style="width:120px; height:auto;">

	</div>

	<!-- Footer -->
	<footer class="footer bg-white text-muted border-top py-3">
		<div class="container d-flex flex-column flex-md-row justify-content-between align-items-center small">
			<span>&copy; @DateTime.Now.Year chhedaproperty.com</span>
			<div>
				<a href="#" class="text-muted text-decoration-none me-3">Privacy</a>
				<a href="#" class="text-muted text-decoration-none">Terms</a>
			</div>
		</div>
	</footer>
	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script> <!-- Add this -->
	<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="~/lib/aos/aos.min.js" asp-append-version="true"></script>
	<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
	<script src="~/lib/choices/choices.min.js"></script>
	<script src="https://cdn.datatables.net/2.3.2/js/dataTables.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<script src="~/js/site.js" asp-append-version="true"></script>
	<script>
		 const notyf = new Notyf({
			duration: 3000,
			position: { x: 'right', y: 'top' }
		});

		document.addEventListener('DOMContentLoaded', function () {
			AOS.init({
				duration: 800, // animation duration in ms
				once: true     // only animate once per scroll
			});
		});

			 // ✅ Hide loader after page loads
		window.addEventListener('load', function () {
			document.getElementById("pageLoader").style.display = "none";
		});

		// ✅ Optional: Show loader manually during AJAX calls
		function showLoader() {
			document.getElementById("pageLoader").style.display = "flex";
		}

		function hideLoader() {
			document.getElementById("pageLoader").style.display = "none";
		}

		// ✅ Example usage with jQuery AJAX
		$(document).ajaxStart(function () {
			showLoader();
		}).ajaxStop(function () {
			hideLoader();
		});


		$(document).ready(function(){
			var UserRole = $("#UserRole").val();
			if(UserRole == "SUPERADMIN"){
			$.ajax({
					url: '/SuperAdmin/GetNotifications',
					type: 'GET',
					data: {  },
					success: function (data) {
						console.log(data); // expects list of strings
						if(data != null){
							$("#NotificationCount").text(data.notiCount);
							 var $ul = $("#notifListUl");
							$ul.empty(); // Clear old items

							$.each(data.notifications, function (index, item) {
								$ul.append(`
									<li class="list-group-item d-flex align-items-center">
										<i class="bi bi-bell me-2 text-primary"></i> ${item}
									</li>
								`);
							});
						}
					},
					error: function (e) {
						  console.error("Failed to load notifications.");
					}
				});
			}
		})
	</script>
	@await RenderSectionAsync("Scripts", required: false)
</body>
</html>
