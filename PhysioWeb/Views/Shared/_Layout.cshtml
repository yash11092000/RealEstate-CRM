<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - Find My Roof</title>
	<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
	<link rel="stylesheet" href="~/PhysioWeb.styles.css" asp-append-version="true" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
	<link href="~/css/aos.min.css" rel="stylesheet" asp-append-version="true" />
	<link href="~/css/choices.min.css" rel="stylesheet" asp-append-version="true" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_green.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.min.css" />
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">

	@{
		var theme = User.FindFirst("Theme")?.Value ?? "#198754";
	}
	<style>

		:root {
			--theme-color: @theme;
		}

		html {
			scroll-behavior: smooth;
		}

		.text-success {
			color: var(--theme-color) !important;
		}

		.btn-outline-success:hover {
			background-color: var(--theme-color) !important;
		}

		.btn:hover {
			color: #212529;
		}

		.btn-outline-success {
			color: var(--theme-color) !important;
			border-color: var(--theme-color) !important;
		}

		.bg-dark-green {
			background-color: var(--theme-color) !important;
		}

		.bg-success {
			background-color: var(--theme-color) !important;
		}

		.btn-success {
			color: #fff !important;
			background-color: var(--theme-color) !important;
			border-color: var(--theme-color) !important;
		}

		.navbar-dark .navbar-nav .nav-link {
			color: white !important;
		}

		.navbar-dark .navbar-brand {
			color: white !important;
		}

		.navbar-nav .nav-link {
			color: #ffffffcc;
			transition: all 0.3s ease-in-out;
			position: relative;
			font-weight: 500;
		}

			.navbar-nav .nav-link:hover {
				color: #ffffff; /* pure white on hover */
			}

			.navbar-nav .nav-link::after {
				content: "";
				position: absolute;
				width: 0%;
				height: 2px;
				background-color: #ffffff; /* white underline */
				left: 0;
				bottom: 0;
				transition: 0.3s;
			}

			.navbar-nav .nav-link:hover::after {
				width: 100%;
			}

		.footer a:hover {
			color: var(--theme-color) !important;
		}

		.impMark {
			color: #f75d5d;
		}

		#TableList {
			width: 100% !important;
			border-collapse: collapse;
		}

			#TableList thead th {
				background-color: #e9f5e9;
				color: var(--theme-color) !important;
				font-weight: 600;
				text-align: center;
				vertical-align: middle;
			}

			#TableList tbody tr:hover {
				background-color: white;
			}

			#TableList tbody td {
				vertical-align: middle;
				text-align: center;
			}

			#TableList thead input {
				width: 100%;
				padding: 5px;
				box-sizing: border-box;
				font-size: 0.9rem;
			}

		.dataTables_wrapper .dataTables_paginate .paginate_button {
			padding: 0.3rem 0.75rem;
			margin: 2px;
			border-radius: 0.3rem;
		}

			.dataTables_wrapper .dataTables_paginate .paginate_button.current {
				background-color: var(--theme-color) !important;
				color: white !important;
				border: 1px solid var(--theme-color) !important;
			}

		.dataTables_wrapper .dataTables_filter input,
		.dataTables_wrapper .dataTables_length select {
			border-radius: 5px;
			padding: 5px;
			border: 1px solid #ced4da;
		}

		.footer {
			margin-top: auto; /* Push footer to bottom */
			width: 100%;
		}

		@@media (max-width: 576px) {
			.content-area {
				padding: 10px;
			}

			.footer {
				padding: 15px 0;
			}
		}

		footer {
			line-height: 30px !important;
		}

		.slide-btn {
			position: relative;
			overflow: hidden;
			transition: color 0.3s;
			z-index: 1;
		}

			.slide-btn:hover {
				color: #fff !important;
			}

				.slide-btn:hover::before {
					width: 100%;
				}

		.slide-btn {
			position: relative;
			overflow: hidden;
			z-index: 1;
			color: #fff;
			border: 2px solid var(--theme-color);
			background: transparent;
			padding: 10px 20px;
			cursor: pointer;
		}

			.slide-btn::before {
				content: "";
				position: absolute;
				left: 0;
				top: 0;
				bottom: 0;
				width: 0;
				background: var(--theme-color); /* dynamic theme color */
				z-index: -1;
				transition: width 0.4s cubic-bezier(0.45,0,0.55,1);
			}

		.dt-length {
			display: flex !important;
			gap: 6px !important;
		}

		.dnone {
			display: none !important;
		}


		/* Sidebar Styles */
		#agencySidebar {
			min-height: calc(100vh - 60px);
			width: var(--sidebar-width);
			position: fixed;
			top: 60px;
			left: 0;
			transition: all var(--transition-speed) ease;
			z-index: 1010;
			box-shadow: 3px 0 10px rgba(0, 0, 0, 0.1);
			background-color: var(--theme-color);
			display: flex;
			flex-direction: column;
		}

			#agencySidebar.collapsed {
				width: var(--sidebar-collapsed-width);
			}

			#agencySidebar .sidebar-header {
				padding: 20px;
				border-bottom: 1px solid rgba(255, 255, 255, 0.1);
				transition: all var(--transition-speed) ease;
				display: flex;
				align-items: center;
				justify-content: space-between;
				flex-shrink: 0; /* Prevent header from shrinking */
			}

			#agencySidebar.collapsed .sidebar-header {
				padding: 20px 10px;
			}

			#agencySidebar .sidebar-header h4 {
				color: white;
				margin: 0;
				white-space: nowrap;
				overflow: hidden;
				transition: all var(--transition-speed) ease;
				font-size: 1.1rem;
			}

			#agencySidebar.collapsed .sidebar-header h4 {
				opacity: 0;
				width: 0;
			}

			/* Scrollable menu container */
			#agencySidebar .sidebar-menu-container {
				flex: 1;
				overflow-y: auto;
				overflow-x: hidden;
				padding: 0;
				margin: 0;
				scrollbar-width: thin;
				scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
			}

				/* Custom scrollbar for webkit browsers */
				#agencySidebar .sidebar-menu-container::-webkit-scrollbar {
					width: 6px;
				}

				#agencySidebar .sidebar-menu-container::-webkit-scrollbar-track {
					background: transparent;
				}

				#agencySidebar .sidebar-menu-container::-webkit-scrollbar-thumb {
					background-color: rgba(255, 255, 255, 0.3);
					border-radius: 3px;
				}

					#agencySidebar .sidebar-menu-container::-webkit-scrollbar-thumb:hover {
						background-color: rgba(255, 255, 255, 0.5);
					}

			#agencySidebar ul.components {
				padding: 0;
				margin: 0;
				list-style: none;
				min-height: min-content; /* Ensure proper height calculation */
			}

			#agencySidebar ul li {
				position: relative;
			}

				#agencySidebar ul li a {
					padding: 12px 20px;
					display: flex;
					align-items: center;
					color: rgba(255, 255, 255, 0.8);
					text-decoration: none;
					transition: all 0.2s ease;
					white-space: nowrap;
					border-left: 3px solid transparent;
				}

					#agencySidebar ul li a:hover {
						background-color: rgba(255, 255, 255, 0.1);
						color: white;
					}

				#agencySidebar ul li.active > a {
					background-color: rgba(255, 255, 255, 0.15);
					color: white;
					border-left-color: #fff;
				}

				#agencySidebar ul li a i {
					margin-right: 15px;
					font-size: 1.2rem;
					min-width: 30px;
					text-align: center;
					transition: margin-right var(--transition-speed) ease;
				}

			#agencySidebar.collapsed ul li a i {
				margin-right: 0;
			}

			#agencySidebar ul li a span {
				transition: opacity var(--transition-speed) ease;
				flex: 1;
			}

			#agencySidebar.collapsed ul li a span {
				opacity: 0;
				width: 0;
				overflow: hidden;
			}

		/* Dropdown arrow */
		.dropdown-arrow {
			margin-left: auto;
			transition: transform 0.3s ease;
		}

		#agencySidebar.collapsed .dropdown-arrow {
			display: none;
		}

		/* Child menu items */
		.child-menu {
			max-height: 0;
			overflow: hidden;
			transition: max-height 0.3s ease;
			background-color: rgba(0, 0, 0, 0.1);
		}

			.child-menu.show {
				max-height: 500px;
			}

			.child-menu li a {
				padding-left: 50px !important;
				font-size: 0.9rem;
				border-left: 3px solid transparent;
			}

				.child-menu li a:hover {
					background-color: rgba(255, 255, 255, 0.05);
				}

			.child-menu li.active a {
				border-left-color: rgba(255, 255, 255, 0.7);
			}

		#agencySidebar.collapsed .child-menu {
			display: none !important;
		}

		/* Parent item indicator */
		.has-children > a::after {
			content: "";
			margin-left: auto;
			border: solid rgba(255, 255, 255, 0.6);
			border-width: 0 2px 2px 0;
			display: inline-block;
			padding: 3px;
			transform: rotate(45deg);
			transition: transform 0.3s ease;
		}

		.has-children.open > a::after {
			transform: rotate(-135deg);
		}

		#agencySidebar.collapsed .has-children > a::after {
			display: none;
		}

		/* Content Area Styles */
		.dashboard-content {
			transition: margin-left var(--transition-speed) ease;
			min-height: calc(100vh - 60px);
		}

			.dashboard-content.with-sidebar {
				margin-left: var(--sidebar-width);
			}

				.dashboard-content.with-sidebar.collapsed {
					margin-left: var(--sidebar-collapsed-width);
				}

		/* Toggle Button */
		.sidebar-toggle {
			background-color: transparent;
			border: none;
			color: white;
			font-size: 1.3rem;
			cursor: pointer;
			padding: 5px 10px;
			border-radius: 4px;
			transition: background-color 0.2s;
		}

			.sidebar-toggle:hover {
				background-color: rgba(255, 255, 255, 0.1);
			}

		/* Mobile Responsive */
		@@media (max-width: 768px) {
			#agencySidebar {
				width: var(--sidebar-collapsed-width);
				transform: translateX(-100%);
			}

				#agencySidebar.mobile-open {
					transform: translateX(0);
					width: var(--sidebar-width);
				}

				#agencySidebar .sidebar-header h4,
				#agencySidebar ul li a span {
					opacity: 0;
					width: 0;
				}

				#agencySidebar ul li a i {
					margin-right: 0;
				}

			.dashboard-content.with-sidebar {
				margin-left: 0;
			}

			#agencySidebar.mobile-open .sidebar-header h4,
			#agencySidebar.mobile-open ul li a span {
				opacity: 1;
				width: auto;
			}

			#agencySidebar.mobile-open ul li a i {
				margin-right: 15px;
			}

			.mobile-sidebar-toggle {
				display: block !important;
			}

			#agencySidebar.mobile-open .child-menu {
				display: block !important;
			}

			#agencySidebar.mobile-open .has-children > a::after {
				display: inline-block;
			}
		}

		/* Mobile Sidebar Toggle Button */
		.mobile-sidebar-toggle {
			display: none;
			background: none;
			border: none;
			font-size: 1.5rem;
			color: #6c757d;
			margin-right: 10px;
		}
		/* Fix sidebar scrolling */
		#agencySidebar {
			height: calc(100vh - 60px);
			overflow-y: auto;
			overflow-x: hidden;
		}

			/* Custom scrollbar */
			#agencySidebar::-webkit-scrollbar {
				width: 6px;
			}

			#agencySidebar::-webkit-scrollbar-track {
				background: transparent;
			}

			#agencySidebar::-webkit-scrollbar-thumb {
				background-color: rgba(255, 255, 255, 0.3);
				border-radius: 3px;
			}

				#agencySidebar::-webkit-scrollbar-thumb:hover {
					background-color: rgba(255, 255, 255, 0.5);
				}

	</style>
</head>
<body>
	<header class="sticky-top">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark-green">
			<div class="container-fluid">
				<a class="navbar-brand d-flex align-items-center" href="/">
					<i class="bi bi-house-door-fill me-2 text-light"></i>
					<strong class="text-light">@User.Identity.Name</strong>
				</a>
				<button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse justify-content-end" id="navbarNav">
					<ul class="navbar-nav">
						<li class="nav-item"><a class="nav-link text-dark" href="/">Home</a></li>
						@if (User.IsInRole("SuperAdmin"))
						{
							<li class="nav-item"><a class="nav-link text-dark" href="/SuperAdmin/AdminDashboard">SuperAdmin Dashboard</a></li>
						}
						@if (User.IsInRole("Agency"))
						{
							<li class="nav-item"><a class="nav-link text-dark" href="/Agent/AgencyDashboard">Admin Dashboard</a></li>
						}
						@if (User.IsInRole("User"))
						{
							<li class="nav-item"><a class="nav-link text-dark" href="#">Buy</a></li>
							<li class="nav-item"><a class="nav-link text-dark" href="#">Sell</a></li>
							<li class="nav-item"><a class="nav-link text-dark" href="#">Rent</a></li>
						}
						@if (!User.Identity.IsAuthenticated)
						{
							<li class="nav-item"><a class="nav-link text-dark" href="/Home/Register">Sign Up</a></li>
							<li class="nav-item"><a class="nav-link text-dark" href="/Home/Login">Login</a></li>
						}
						else
						{

							string role = User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value?.ToUpper() ?? "";
							string icon = "bi-person"; // default icon

							@* if (role == "SUPERADMIN") { icon = "bi-shield-lock"; }
							else if (role == "AGENCY") { icon = "bi-building"; }
							else if (role == "USER") { icon = "bi-person-circle"; }

							<li class="nav-item">
								<input type="text" value="@role" hidden id="UserRole" />
								<span class="nav-link text-dark" style="font-weight:500;">
									<i class="bi @icon me-1"></i> @User.Identity.Name
								</span>
							</li> *@
							@if (User.IsInRole("SuperAdmin"))
							{
								<li>
									<button class="btn btn-light position-relative" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
										<i class="bi bi-bell"></i>
										<span class="mt-1 position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="NotificationCount">
											0
										</span>
									</button>
								</li>
							}

							<li class="nav-item"><a class="nav-link text-dark" href="/Home/Logout">Logout</a></li>

						}


					</ul>
				</div>
			</div>
		</nav>

	</header>


	<div class="container-fluid">
		<main role="main" class="pb-3">

			<div id="Side_Bar">
				<div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
					<div class="offcanvas-header">
						<h5 class="offcanvas-title" id="offcanvasScrollingLabel">Colored with scrolling</h5>
						<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
					</div>
					<div class="offcanvas-body">
						<p>Try scrolling the rest of the page to see this option in action.</p>
					</div>
				</div>
			</div>

			<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
				<div class="offcanvas-header">
					<h5 id="offcanvasRightLabel">Notifications</h5>
					<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
				</div>
				<div class="offcanvas-body" id="NotifiactionList">
					<ul class="list-group list-group-flush" id="notifListUl">
					</ul>
				</div>
			</div>
			@{
				var currentPath = ViewContext.HttpContext?.Request?.Path.Value?.ToLower() ?? "";
				var fullPath = ViewContext.HttpContext?.Request?.Path + ViewContext.HttpContext?.Request?.QueryString;
				var excludedPaths = new[]
				{
			"/",
			"/propertydetails/property",
			"/home/searchproperty"
			};
				@if (User.IsInRole("Agency") && !excludedPaths.Contains(currentPath))
				{
					<!-- Agency Sidebar with Scrollable Container -->
					<nav id="agencySidebar" class="collapsed">
						<div class="sidebar-header">
							<h4>Agency Menu</h4>
							<button type="button" id="sidebarToggle" class="sidebar-toggle">
								<i class="bi bi-chevron-right"></i>
							</button>
						</div>

						<div class="sidebar-menu-container">
							<ul class="components">
								<li class="active">
									<a href="/Agent/AgencyDashboard">
										<i class="bi bi-speedometer2"></i>
										<span>Dashboard</span>
									</a>
								</li>

								<!-- Parent menu with children -->
								<li class="has-children">
									<a href="#propertiesSubmenu" data-bs-toggle="collapse" aria-expanded="false">
										<i class="bi bi-house"></i>
										<span>Properties</span>
									</a>
									<ul class="child-menu collapse" id="propertiesSubmenu">
										<li><a href="/Agent/Properties/All"><i class="bi bi-list-ul"></i> All Properties</a></li>
										<li><a href="/Agent/Properties/Active"><i class="bi bi-check-circle"></i> Active Listings</a></li>
										<li><a href="/Agent/Properties/Pending"><i class="bi bi-clock"></i> Pending</a></li>
										<li><a href="/Agent/Properties/Sold"><i class="bi bi-check-lg"></i> Sold Properties</a></li>
										<li><a href="/Agent/Properties/Archived"><i class="bi bi-archive"></i> Archived</a></li>
										<li><a href="/Agent/Properties/Drafts"><i class="bi bi-file-earmark"></i> Drafts</a></li>
									</ul>
								</li>

								<li>
									<a href="/Agent/AddProperty">
										<i class="bi bi-plus-circle"></i>
										<span>Add Property</span>
									</a>
								</li>

								<!-- Parent menu with children -->
								<li class="has-children">
									<a href="#clientsSubmenu" data-bs-toggle="collapse" aria-expanded="false">
										<i class="bi bi-people"></i>
										<span>Clients</span>
									</a>
									<ul class="child-menu collapse" id="clientsSubmenu">
										<li><a href="/Agent/Clients/Buyers"><i class="bi bi-cart"></i> Buyers</a></li>
										<li><a href="/Agent/Clients/Sellers"><i class="bi bi-house"></i> Sellers</a></li>
										<li><a href="/Agent/Clients/Leads"><i class="bi bi-telephone"></i> Leads</a></li>
										<li><a href="/Agent/Clients/Referrals"><i class="bi bi-person-plus"></i> Referrals</a></li>
										<li><a href="/Agent/Clients/Import"><i class="bi bi-upload"></i> Import Clients</a></li>
									</ul>
								</li>

								<!-- Parent menu with children -->
								<li class="has-children">
									<a href="#appointmentsSubmenu" data-bs-toggle="collapse" aria-expanded="false">
										<i class="bi bi-calendar"></i>
										<span>Appointments</span>
									</a>
									<ul class="child-menu collapse" id="appointmentsSubmenu">
										<li><a href="/Agent/Appointments/Upcoming"><i class="bi bi-calendar-check"></i> Upcoming</a></li>
										<li><a href="/Agent/Appointments/Completed"><i class="bi bi-check-all"></i> Completed</a></li>
										<li><a href="/Agent/Appointments/Cancelled"><i class="bi bi-x-circle"></i> Cancelled</a></li>
										<li><a href="/Agent/Appointments/Schedule"><i class="bi bi-plus-circle"></i> Schedule New</a></li>
										<li><a href="/Agent/Appointments/Calendar"><i class="bi bi-calendar-week"></i> Calendar View</a></li>
									</ul>
								</li>

								<!-- Parent menu with children -->
								<li class="has-children">
									<a href="#reportsSubmenu" data-bs-toggle="collapse" aria-expanded="false">
										<i class="bi bi-bar-chart"></i>
										<span>Reports</span>
									</a>
									<ul class="child-menu collapse" id="reportsSubmenu">
										<li><a href="/Agent/Reports/Sales"><i class="bi bi-graph-up"></i> Sales Report</a></li>
										<li><a href="/Agent/Reports/Performance"><i class="bi bi-speedometer"></i> Performance</a></li>
										<li><a href="/Agent/Reports/Commission"><i class="bi bi-cash"></i> Commission</a></li>
										<li><a href="/Agent/Reports/Listings"><i class="bi bi-house"></i> Listing Report</a></li>
										<li><a href="/Agent/Reports/Client"><i class="bi bi-people"></i> Client Report</a></li>
										<li><a href="/Agent/Reports/Export"><i class="bi bi-download"></i> Export Data</a></li>
									</ul>
								</li>

								<!-- Parent menu with children -->
								<li class="has-children">
									<a href="#marketingSubmenu" data-bs-toggle="collapse" aria-expanded="false">
										<i class="bi bi-megaphone"></i>
										<span>Marketing</span>
									</a>
									<ul class="child-menu collapse" id="marketingSubmenu">
										<li><a href="/Agent/Marketing/Email"><i class="bi bi-envelope"></i> Email Campaigns</a></li>
										<li><a href="/Agent/Marketing/Social"><i class="bi bi-share"></i> Social Media</a></li>
										<li><a href="/Agent/Marketing/Flyers"><i class="bi bi-file-image"></i> Property Flyers</a></li>
										<li><a href="/Agent/Marketing/Ads"><i class="bi bi-badge-ad"></i> Advertising</a></li>
									</ul>
								</li>

								<!-- Parent menu with children -->
								<li class="has-children">
									<a href="#financeSubmenu" data-bs-toggle="collapse" aria-expanded="false">
										<i class="bi bi-wallet"></i>
										<span>Finance</span>
									</a>
									<ul class="child-menu collapse" id="financeSubmenu">
										<li><a href="/Agent/Finance/Invoices"><i class="bi bi-receipt"></i> Invoices</a></li>
										<li><a href="/Agent/Finance/Expenses"><i class="bi bi-currency-dollar"></i> Expenses</a></li>
										<li><a href="/Agent/Finance/Commission"><i class="bi bi-percent"></i> Commission Tracking</a></li>
										<li><a href="/Agent/Finance/Taxes"><i class="bi bi-calculator"></i> Tax Reports</a></li>
									</ul>
								</li>

								<li>
									<a href="/Agent/Settings">
										<i class="bi bi-gear"></i>
										<span>Settings</span>
									</a>
								</li>

								<li>
									<a href="/Agent/Help">
										<i class="bi bi-question-circle"></i>
										<span>Help & Support</span>
									</a>
								</li>
							</ul>
						</div>
					</nav>
				}
			}


			@RenderBody()
		</main>
	</div>
	<!-- 🌟 Loader -->
	<div id="pageLoader"
		 style="position: fixed; top: 0; left: 0; width: 100%; height: 100%;
				background: rgba(255,255,255,0.9);
				display: flex; justify-content: center;
				align-items: center; z-index: 9999;">
		<img src="~/time hourglass.gif" alt="Loading..." style="width:120px; height:auto;">

	</div>

	<!-- Footer -->
	<footer class="footer bg-white text-muted border-top py-3">
		<div class="container d-flex flex-column flex-md-row justify-content-between align-items-center small">
			<span>&copy; @DateTime.Now.Year chhedaproperty.com</span>
			<div>
				<a href="#" class="text-muted text-decoration-none me-3">Privacy</a>
				<a href="#" class="text-muted text-decoration-none">Terms</a>
			</div>
		</div>
	</footer>
	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script> <!-- Add this -->
	<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="~/lib/aos/aos.min.js" asp-append-version="true"></script>
	<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
	<script src="~/lib/choices/choices.min.js"></script>
	<script src="https://cdn.datatables.net/2.3.2/js/dataTables.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<script src="~/js/site.js" asp-append-version="true"></script>
	<script>
		 const notyf = new Notyf({
			duration: 3000,
			position: { x: 'right', y: 'top' }
		});

		document.addEventListener('DOMContentLoaded', function () {
			AOS.init({
				duration: 800, // animation duration in ms
				once: true     // only animate once per scroll
			});
		});

			 // ✅ Hide loader after page loads
		window.addEventListener('load', function () {
			document.getElementById("pageLoader").style.display = "none";
		});

		// ✅ Optional: Show loader manually during AJAX calls
		function showLoader() {
			document.getElementById("pageLoader").style.display = "flex";
		}

		function hideLoader() {
			document.getElementById("pageLoader").style.display = "none";
		}

		// ✅ Example usage with jQuery AJAX
		$(document).ajaxStart(function () {
			showLoader();
		}).ajaxStop(function () {
			hideLoader();
		});


		$(document).ready(function(){
			var UserRole = $("#UserRole").val();
			if(UserRole == "SUPERADMIN"){
			$.ajax({
					url: '/SuperAdmin/GetNotifications',
					type: 'GET',
					data: {  },
					success: function (data) {
						console.log(data); // expects list of strings
						if(data != null){
							$("#NotificationCount").text(data.notiCount);
							 var $ul = $("#notifListUl");
							$ul.empty(); // Clear old items

							$.each(data.notifications, function (index, item) {
								$ul.append(`
									<li class="list-group-item d-flex align-items-center">
										<i class="bi bi-bell me-2 text-primary"></i> ${item}
									</li>
								`);
							});
						}
					},
					error: function (e) {
						  console.error("Failed to load notifications.");
					}
				});
			}
		})

				document.addEventListener('DOMContentLoaded', function() {
			const navbarBrand = document.querySelector('.navbar-brand');
			if (navbarBrand && !document.getElementById('mobileSidebarToggle')) {
				const mobileToggle = document.createElement('button');
				mobileToggle.className = 'mobile-sidebar-toggle me-2';
				mobileToggle.id = 'mobileSidebarToggle';
				mobileToggle.innerHTML = '<i class="bi bi-list"></i>';
				navbarBrand.parentNode.insertBefore(mobileToggle, navbarBrand);
			}
		});

		document.addEventListener('DOMContentLoaded', function() {
			const agencySidebar = document.getElementById('agencySidebar');
			const dashboardContent = document.querySelector('.dashboard-content');
			const sidebarToggle = document.getElementById('sidebarToggle');
			const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
			const mobileSidebarToggleBtn = document.getElementById('mobileSidebarToggleBtn');
			const sidebarMenuContainer = document.querySelector('.sidebar-menu-container');

			// Toggle sidebar on button click
			if (sidebarToggle) {
				sidebarToggle.addEventListener('click', function() {
					agencySidebar.classList.toggle('collapsed');
					dashboardContent.classList.toggle('collapsed');

					// Change icon based on state
					const icon = sidebarToggle.querySelector('i');
					if (agencySidebar.classList.contains('collapsed')) {
						icon.classList.remove('bi-chevron-left');
						icon.classList.add('bi-chevron-right');
					} else {
						icon.classList.remove('bi-chevron-right');
						icon.classList.add('bi-chevron-left');
					}
				});
			}

			// Mobile sidebar toggle from navbar
			if (mobileSidebarToggle) {
				mobileSidebarToggle.addEventListener('click', function() {
					agencySidebar.classList.toggle('mobile-open');
				});
			}

			// Mobile sidebar toggle from content area
			if (mobileSidebarToggleBtn) {
				mobileSidebarToggleBtn.addEventListener('click', function() {
					agencySidebar.classList.toggle('mobile-open');
				});
			}

			// Handle child menu items in collapsed state
			const parentMenuItems = document.querySelectorAll('.has-children > a');
			parentMenuItems.forEach(item => {
				item.addEventListener('click', function(e) {
					if (agencySidebar.classList.contains('collapsed') && !agencySidebar.classList.contains('mobile-open')) {
						e.preventDefault();
						// When sidebar is collapsed, expand it first
						agencySidebar.classList.remove('collapsed');
						dashboardContent.classList.remove('collapsed');
						sidebarToggle.querySelector('i').classList.replace('bi-chevron-right', 'bi-chevron-left');

						// Then open the submenu after a slight delay
						setTimeout(() => {
							const target = this.getAttribute('href');
							const submenu = document.querySelector(target);
							if (submenu) {
								const bsCollapse = new bootstrap.Collapse(submenu, { toggle: true });
							}
						}, 300);
					}
				});
			});

			// Auto-collapse on mobile
			if (window.innerWidth <= 768) {
				agencySidebar.classList.add('collapsed');
				dashboardContent.classList.add('collapsed');
			}

			// Handle window resize
			window.addEventListener('resize', function() {
				if (window.innerWidth <= 768) {
					agencySidebar.classList.add('collapsed');
					dashboardContent.classList.add('collapsed');
					agencySidebar.classList.remove('mobile-open');
				} else {
					agencySidebar.classList.remove('collapsed');
					dashboardContent.classList.remove('collapsed');
					agencySidebar.classList.remove('mobile-open');
				}
			});

			// Close mobile sidebar when clicking on a menu item
			const sidebarLinks = document.querySelectorAll('#agencySidebar ul li a:not([data-bs-toggle="collapse"])');
			sidebarLinks.forEach(link => {
				link.addEventListener('click', function() {
					if (window.innerWidth <= 768) {
						agencySidebar.classList.remove('mobile-open');
					}
				});
			});

			// Set theme color for sidebar
			const themeColor = getComputedStyle(document.documentElement).getPropertyValue('--theme-color').trim();
			if (agencySidebar) {
				agencySidebar.style.backgroundColor = themeColor;
			}

			// Initialize Bootstrap collapse for submenus
			const collapses = document.querySelectorAll('.collapse');
			collapses.forEach(collapse => {
				new bootstrap.Collapse(collapse, { toggle: false });
			});

			// Auto-scroll to active menu item
			function scrollToActiveMenuItem() {
				const activeMenuItem = document.querySelector('#agencySidebar .active');
				if (activeMenuItem && sidebarMenuContainer) {
					setTimeout(() => {
						activeMenuItem.scrollIntoView({
							behavior: 'smooth',
							block: 'center',
							inline: 'nearest'
						});
					}, 100);
				}
			}

			// Scroll to active item on page load
			scrollToActiveMenuItem();

			const submenuTriggers = document.querySelectorAll('[data-bs-toggle="collapse"]');
			submenuTriggers.forEach(trigger => {
				trigger.addEventListener('click', function() {
					const target = this.getAttribute('href');
					const submenu = document.querySelector(target);

					if (submenu) {
						// Wait for the submenu to open, then ensure it's visible
						setTimeout(() => {
							if (submenu.classList.contains('show')) {
								this.closest('.has-children').scrollIntoView({
									behavior: 'smooth',
									block: 'nearest'
								});
							}
						}, 350);
					}
				});
			});
		});
	</script>
	@await RenderSectionAsync("Scripts", required: false)
</body>
</html>
